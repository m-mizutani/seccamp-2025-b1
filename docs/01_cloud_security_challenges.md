# クラウド環境でもセキュリティ監視が必要な理由

**時間：8:40-8:55  (15分)**


## 🚨 クラウド環境における基本的なセキュリティの理解

クラウド移行時によくある誤解として「クラウドプロバイダーが全てのセキュリティを担保してくれる」というものがあります。しかし実際には、クラウド環境でも従来と同様、むしろそれ以上にセキュリティ監視が重要になります。

### 「クラウドプロバイダーが守ってくれる」という誤解と現実

クラウドサービスでは「責任共有モデル」により、プロバイダーと利用者の責任範囲が明確に分かれています。

| サービス層 | 代表的なサービス | プロバイダー責任 | 利用者責任 |
|-----------|------------------|------------------|-------------|
| **IaaS**<br>(Infrastructure as a Service) | AWS EC2<br>Azure Virtual Machines<br>GCP Compute Engine | ✅ 物理データセンター<br>✅ ネットワークインフラ<br>✅ ホストOS・ハイパーバイザー<br>✅ 物理的な分離・隔離 | ❗ ゲストOS（パッチ管理・設定）<br>❗ アプリケーション<br>❗ データ保護<br>❗ ネットワーク設定<br>❗ ID・アクセス管理 |
| **PaaS**<br>(Platform as a Service) | AWS RDS<br>Azure App Service<br>GCP Cloud SQL | ✅ IaaS層の全責任<br>✅ OSパッチ管理<br>✅ ランタイム環境<br>✅ プラットフォームセキュリティ | ❗ アプリケーションコード<br>❗ データ分類・保護<br>❗ ユーザー認証・認可<br>❗ ネットワークトラフィック制御 |
| **SaaS**<br>(Software as a Service) | Microsoft 365<br>Google Workspace<br>Salesforce | ✅ アプリケーション全体<br>✅ インフラ・プラットフォーム<br>✅ データセンター物理セキュリティ<br>✅ 基本的なデータ保護 | ❗ ユーザー管理・権限設定<br>❗ データ分類・ラベリング<br>❗ 不正使用の検知・対応<br>❗ コンプライアンス設定 |

**重要ポイント**: 上位レイヤーほどプロバイダー責任が拡大するが、基本的なセキュリティ設定は常に利用者責任

### 境界防御に頼らないセキュリティ対策

従来のオンプレミス環境では、ファイアウォールやWAFなどの境界防御が主要なセキュリティ対策でした。これは静的な環境においては有効な側面がありましたが、クラウド環境では以下の理由によりそれ以上の対策が重要です。

- **絶え間ないアーキテクチャの変更**: 構成変更可能なのがクラウドの強みでもあり、弱みになりうる
- **動的なリソース**: Auto Scalingやコンテナにより定常的な運用でもリソースが増減
- **APIベースのアクセス**: 全ての操作がAPIで行われ、正規の認証情報があれば世界中からアクセス可能

### セキュリティ対策を促進するサービス郡

クラウド環境ではより精緻なセキュリティ管理を実現できるよう、様々な機能が提供されています。これらを活用し、インフラやアプリケーションの保護をしていくことが重要です。

- IAM（Identity and Access Management）：様々な条件にもとづく権限管理
- シークレット管理、鍵管理：機密情報のより厳密な管理
- CSPM（Cloud Security Posture Management）：セキュリティ設定の監視
- 認証管理サービス：認証やトークンの発行制御など

## 💡 クラウドのセキュリティ監視の必要性

本質的には情報セキュリティ全般の監視と同じですが、クラウド特有の事情もあります。

### 認証情報の悪用リスク

クラウド環境では有効な認証情報さえあれば世界中どこからでもアクセス可能なため、以下のような脅威への対策が必要です。

**外部からの脅威**:
- **認証情報の漏洩**: サプライチェーン攻撃、フィッシング、マルウェア経由での窃取
- **アカウント乗っ取り**: 退職者アカウントの悪用、休眠アカウントへの侵害

**内部からの脅威**:
- **悪意のある不正利用**: データ持ち出し、競合他社への情報提供、権限濫用

これらは全て「正規のアクセス」として処理されるため、従来の防御システムでは対応が困難です。

### クラウド設定リスク

クラウドの柔軟性と複雑性により、以下のような設定起因のリスクが増大します。特にクラウドは積極的にアーキテクチャを変更することが多く、その変更によって問題が発生する事が多いです。

**設定ミスによる露出**:
- **S3バケットの誤公開**: 世界中で日々発生している最も一般的な事故
- **セキュリティグループの過剰開放**: 「とりあえず動かすため」の一時的設定が恒久化
- **IAMポリシーの過剰権限**: 最小権限の原則から逸脱した「フルアクセス」設定

**運用上の設定エラー**:
- **誤操作**: データ削除、システム停止、設定の意図しない変更
- **ポリシー違反**: 個人端末へのデータコピー、未承認ツールの使用

## 🏫 実践的ケーススタディ：監視体制の不備による問題

### ケース1：初期フェーズでの典型的なインシデント

**インシデント1: 自動化された攻撃への対処不足**

スタートアップ企業によくある「まだ小規模だから狙われない」という認識は誤りです。実際の事例：

- **発生事象**: EC2インスタンスが暗号通貨マイニングに悪用
- **原因分析**: デフォルト設定のまま運用、パッチ未適用、過度に開放的なセキュリティグループ
- **学習ポイント**: インターネット公開時点で攻撃対象となる。規模は関係ない

**インシデント2: アイデンティティ管理の盲点**

退職者アカウントの放置は深刻なリスクとなります：

- **発生事象**: 退職6ヶ月後のアカウントから大量データダウンロード
- **検出の遅れ**: 通常の数十倍のアクセスがあったが、数週間気づかず
- **教訓**: 正規の認証情報による不正アクセスは、境界防御では防げない

監視していれば検出できた兆候：
- 深夜の異常なアクセスパターン
- 通常と桁違いのデータ転送量
- 普段と異なる地域からのアクセス

**インシデント3: 設定ミスによる意図しないデータ公開**

「一時的な」設定変更が恒久化する典型例：

- **発生事象**: S3バケットの公開設定が3ヶ月間放置
- **影響**: 個人情報を含むファイルがインターネットから閲覧可能に
- **根本原因**: レビュープロセスの欠如、設定変更の追跡なし

### ケース2：成長フェーズでの疑惑インシデントの調査不能

**インシデントが疑われたが証拠を掴めなかった事例**

社内システムへの不正アクセスが疑われる複数の兆候が報告されました：

- 特定の顧客データが競合他社に漏洩した可能性を示唆する情報
- 社員から「普段と異なるシステムの挙動」の報告
- データベースのレスポンスが一時的に極端に遅くなる事象

しかし、調査に必要なログが不足していたため真相究明は不可能でした：

**不足していたログと調査への影響**：
- **アプリケーションログ未取得**: ユーザーの詳細な操作履歴が不明
- **データベース監査ログ無効**: どのデータにアクセスされたか追跡不可
- **ネットワークフローログ未設定**: 異常な通信パターンの検証不可
- **S3アクセスログ未設定**: ファイルアクセスの履歴が存在せず

**結果として生じた問題**：
- インシデントの有無すら確定できない状況
- 顧客への説明責任を果たせず信頼関係が悪化
- 再発防止策を策定できない（原因が不明のため）

**教訓**：
- 「何かおかしい」と感じた時点では既に手遅れ
- ログは事前に取得・保存しておかなければ、後から遡ることは不可能
- インシデントレスポンスの第一歩は、十分なログの存在

## まとめ

クラウド環境は便利で拡張性がありますが、それは攻撃者にとっても同じです。API経由で全てが操作できるクラウドだからこそ、全ての操作を監視する必要があります。
