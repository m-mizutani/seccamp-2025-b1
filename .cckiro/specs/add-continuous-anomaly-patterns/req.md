# 要件: 継続的な異常パターンの追加

## 概要
loggenツールに新しい異常パターンを追加し、5分間隔でのクエリでも検知可能な常時発生型の異常イベントを生成できるようにする。

## 背景
現在のloggenには3つの異常パターンが実装されているが、これらは特定の時間帯に集中して発生するパターンである。セキュリティ監視の実習において、より現実的で継続的な脅威を検知する練習をするために、24時間継続的に発生する異常パターンが必要。

## 機能要件

### 1. 新規異常パターンの追加
以下の4つの新しい異常パターンを実装する：

#### PatternExample4HighFreqAuthAttack
- 単一IPからの高頻度パスワード攻撃
- 24時間継続
- 同一IPアドレスから1分間に3-5回の認証失敗
- 複数の異なるユーザーアカウントへの試行
- たまに成功してすぐログアウト

#### PatternExample5RapidDataTheft
- 単一アカウントによる超高速ファイル窃取
- 24時間継続
- 同一ユーザー・同一IPから1分間に10-15件のダウンロード
- 毎回異なるファイル
- ファイルパスは部署やプロジェクトを横断

#### PatternExample6MultiServiceProbing
- 侵害アカウントによる各種サービスへのアクセス試行
- 24時間継続
- 同一アカウントから1分間に3-5回のアクセス試行
- Drive、Calendar、Gmail、Admin等の複数サービスへ
- 多くが権限不足で失敗（status_id = 2）

#### PatternExample7SimultaneousGeoAccess
- 2つの国から同時にアクティブなセッション
- 24時間継続
- 同一ユーザーが2つの異なる国から同時操作
- 各国から1分間に2-3回のアクセス（合計4-6回/分）
- IPアドレスは各国で固定

### 2. 既存機能との互換性
- 既存の3つの異常パターンは変更しない
- 新しいパターンは追加として実装
- 既存のログ生成ロジックに影響を与えない

### 3. 検知可能性
- 1分間隔のクエリで各パターン1-2件以上ヒット
- 5分間隔のクエリで各パターン5件以上ヒット
- 正常ログに適度に埋もれる設計（現実的なノイズレベル）

### 4. ログ生成の仕様変更
- multiplierオプションを廃止
- 常に定量のデータが発生するように変更
- 全体の90-95%は正常ログ、5-10%が異常ログとなるように調整
- 異常パターンが一見して分からない程度に正常ログに埋もれる設計

## 非機能要件

### 1. パフォーマンス
- ログ生成速度が既存実装から大幅に劣化しない
- メモリ使用量が大幅に増加しない

### 2. 保守性
- 新しいパターンは既存のパターン実装と同様の構造で実装
- パターンごとに独立したロジックで実装
- 将来的なパターン追加が容易な設計

### 3. テスタビリティ
- 各パターンの生成が正しく行われることを確認可能
- 生成されたログの統計情報で各パターンの発生頻度を確認可能

## 制約事項
- Go言語で実装
- 既存のloggenのアーキテクチャに従う
- internal/logcore/types.goの定数定義に従う
- tools/loggen/internal/seed/generator.goの実装パターンに従う

## 関連ドキュメントの更新
以下のドキュメントも併せて更新する：

### 1. docs/06_lambda_implementation_and_detection_rules.md
- 新しい異常パターンに対応した検知ルール課題を追加
- 既存の課題と同様のフォーマット（ヒント付き、回答例は隠す）で作成

### 2. docs/05_detection_rules_and_alerts.md（必要に応じて）
- 新しい異常パターンの例を練習問題に含める場合は更新

### 3. README.md または適切なドキュメント
- loggenツールの使用方法にmultiplierオプション廃止について記載
- 新しい異常パターンについての説明を追加